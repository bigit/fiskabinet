<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Список организаций</title>
    <th:block th:replace="include::head"/>
    <script src="https://unpkg.com/htmx.org@1.9.2"></script>
</head>
<body>
<th:block th:replace="include::navigation"/>
<div class="container shadow p-3">


    <h1>Организации</h1>

    <div class="row" th:each="org: ${organizations}">
        <div class="col">
            <table class="table table-bordered table-hover">
                <tr>
                    <td colspan="5">
                        <a th:href="@{|/org/${org.id}|}">
                            <label class="fw-bold" th:text="${org.name}"></label>
                        </a>
                        <a th:if="${urlMap.get(org.id) ne null}" th:href="${urlMap.get(org.id)}" target="_blank"><i
                                class="fa fa-link"></i></a>
                    </td>
                </tr>
                <tr th:if="${not #lists.isEmpty(kkmMap.get(org.id))}" th:each="kkm : ${kkmMap.get(org.id)}">
                    <td style="width: 100px">
                        <a th:href="@{|/kkm/${kkm.id}|}">
                            <label th:text="${kkm.getInnerName()}"></label>
                        </a>
                    </td>
                    <td style="width: 100px;">
                        <label th:text="${kkm.kkmModel ne null ? kkm.kkmModel.name : 'Не указана модель'}"
                               th:class="${kkm.kkmModel eq null ? 'text-danger' : ''}"/>
                    </td>
                    <td style="width: 150px">
                        <label th:text="${kkm.serialNumber ne null ? kkm.serialNumber : 'Нет заводского номера'}"
                               th:class="${kkm.serialNumber eq null ? 'text-danger' : '' }"></label>
                    </td>
                    <td style="width: 150px">
                        <label th:text="${kkm.fnNumber ne null ? kkm.fnNumber : 'Нет номера ФН'}"
                               th:class="${kkm.fnNumber eq null ? 'text-danger' : ''}"></label>
                    </td>
                    <td style="width: 80px">
                        <label th:text="${kkm.fnEnd ne null ? kkm.fnEnd : 'Не указан срок'}"
                               th:class="${kkm.fnEnd lt #dates.createNow()} ? 'text-danger'"></label>
                    </td>
                </tr>
            </table>
        </div>
    </div>
</div>

</body>
</html>